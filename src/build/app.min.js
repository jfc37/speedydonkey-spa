!function(){"use strict";function e(){var e=this;e.passOptionsUrl="#/admin/manage/PassOptions",e.levelsUrl="#/admin/manage/levels",e.blocksUrl="#/admin/manage/blocks",e.classesUrl="#/admin/manage/classes",e.teachersUrl="#/admin/manage/teachers",e.studentsUrl="#/admin/manage/students"}angular.module("app.adminDashboard").controller("AdminDashboard",e),e.$inject=[]}(),function(){"use strict";function e(){var e=this;e.teacherClassHoursUrl="#/admin/reports/teacher_hours",e.profitReportUrl="#/admin/reports/profit"}angular.module("app.adminReports").controller("AdminReports",e),e.$inject=[]}(),function(){"use strict";function e(e){return moment(e).format("dddd D/M")}function t(e){return moment(e,"dddd D/M")}function n(){return function(t,n){return t.filter(function(t){return e(t.start_date)===n})}}function r(){return function(e){var n=new Date,r=e.filter(function(e){var r=t(e).startOf("week");return r.startOf("week")<=n&&r.endOf("week")>=n});return r&&r.any()?r:e.filter(function(e){return t(e).endOf("week")>new Date})}}function a(t,n,r,a){function o(){return s().length>0}function s(){return d.blocks.filter(function(e){return e.enrolIn})}function i(){return d.selectedPass}function c(){var e=[u(),l()];return n.all(e).then(function(){r.info("Activated Block Enrolment View")})}function u(){return t.getBlocks().then(function(t){d.blocks=t;var n,r=[],a=t.length;for(n=0;a>n;n++){var o=e(t[n].start_date);r[o]||(r[o]=!0,d.blockGrouping.push(o))}d.areBlocksLoading=!1},function(e){e.displayMessage||(e.displayMessage="Issue getting blocks..."),r.error(e.displayMessage),d.areBlocksLoading=!1})}function l(){return t.getPassOptions().then(function(e){d.passOptions=e,d.arePassesLoading=!1},function(e){e.displayMessage||(e.arePassesLoading="Issue getting pass options..."),r.error(e.displayMessage),d.arePassesLoading=!1})}var d=this;d.title="Block Enrolment",d.blocks=[],d.passOptions=[],d.areBlocksLoading=!0,d.arePassesLoading=!0,d.blockGrouping=[],d.selectedPass="",d.getClassType=function(e){var t=e.name.toLowerCase();return t.indexOf("charleston")>-1?"charleston":t.indexOf("lindy")>-1?"lindy":t.indexOf("tap")>-1?"tap":t.indexOf("blues")>-1?"blues":t.indexOf("balboa")>-1?"balboa":""},d.isAnythingToSubmit=function(){return o()||i()},d.submit=function(){var e=[t.enrol(s()),t.purchasePass(d.selectedPass)];n.all(e).then(function(){a.redirectToRoute("dashboard"),r.success("Enroled in selected blocks")},function(){r.error("Problem with enrolment")})},c()}angular.module("app.blockEnrolment").filter("matchingBlockGrouping",n).filter("viewableBlocks",r).controller("BlockEnrolment",a),a.$inject=["blockEnrolmentService","$q","logger","routehelper"]}(),function(){"use strict";function e(e,t,n,r,a){function o(){return e(function(e,t){var r=[];n.getAllBlocks().then(function(e){e.forEach(function(e){e.isEnroled=!1}),r=e},function(e){404===e.status&&(e.displayMessage="No blocks found"),t(e)}).then(function(){0!==r.length&&n.getUserEnroledBlocks().then(function(e){var t=e.map(function(e){return e.id});r.forEach(function(e){t.indexOf(e.id)>-1&&(e.isEnroled=!0)})},t)}).then(function(){e(r.filter(function(e){return e.isEnroled===!1}))})})}function s(t){return e(function(e,r){n.getAllPassOptions().then(function(n){t||(n=n.filter(function(e){return e.available_for_purchase})),e(n)},function(e){404===e.status&&(e.displayMessage="No pass options found"),r(e)})})}function i(t){return e(function(e,n){if(t.any()){var o={user_id:a.getUserIdentity().userId,block_ids:t.map(function(e){return e.id})};r.enrolInBlock(o).then(e,n)}else e()})}function c(t){return e(function(e,n){if(t){var a={payment_status:"pending"};r.assignPassToCurrentUser(t.id,a).then(e,n)}else e()})}var u={getBlocks:o,getPassOptions:s,enrol:i,purchasePass:c};return u}angular.module("app.blockEnrolment").factory("blockEnrolmentService",e),e.$inject=["$q","logger","dataservice","dataUpdateService","authService"]}(),function(){"use strict";function e(e,t,n,r,a,o,s){function i(){var t=[c(),u(),l()];return e.all(t).then(function(){a.info("Activated Class Check In View")})}function c(){return t.getClass().then(function(e){d["class"]=e,d.isClassLoading=!1},function(e){e.displayMessage||(e.displayMessage="Issue getting class..."),a.error(e.displayMessage),d.isClassLoading=!1})}function u(){return t.getStudents().then(function(e){d.students=e,d.areRegisteredStudentsLoading=!1},function(e){e.displayMessage||(e.displayMessage="Issue getting registered students..."),a.error(e.displayMessage),d.areRegisteredStudentsLoading=!1})}function l(){return r.getPassOptions(!0).then(function(e){d.passOptions=e,d.arePassesLoading=!1},function(e){e.displayMessage||(e.arePassesLoading="Issue getting pass options..."),a.error(e.displayMessage),d.arePassesLoading=!1})}var d=this;d["class"]=null,d.students=[],d.isClassLoading=!0,d.areRegisteredStudentsLoading=!0,d.creatingNewAccount=!1,d.newUser={},d.updateTeachers=function(){var e={id:d["class"].id,teachers:d["class"].teachers,start_time:d["class"].start_time,end_time:d["class"].end_time,name:d["class"].name};s.update(e).then(function(){a.success("Teachers updated")},function(e){a.error("Problem updating teachers")})},d.attendenceStatusChanged=function(e){t.attendenceStatusChanged(e).then(function(e){a.success(e)},function(e){a.error(e)})},d.searchUsers=function(e){return t.searchUsers(e)},d.addWalkIn=function(){d.walkInStudentSelected.attendedClass=!0,t.getPassesForStudent(d.walkInStudentSelected).then(function(){t.attendenceStatusChanged(d.walkInStudentSelected).then(function(e){a.success(e)},function(e){a.error(e)}),d.students.push(d.walkInStudentSelected),d.walkInStudentSelected=""})},d.enrolWalkIn=function(){t.enrolStudent(d.walkInStudentSelected.id,d["class"].block.id).then(function(){a.success("Enroled "+d.walkInStudentSelected.full_name+" in the block")},function(e){a.error("Problem enroling "+d.walkInStudentSelected.full_name+" in the block...")}).then(d.addWalkIn)},d.isSelectedStudentValid=function(){return d.walkInStudentSelected&&d.walkInStudentSelected.id},d.createAccount=function(){if(d.newUser={},d.walkInStudentSelected){var e=d.walkInStudentSelected.split(" ");e.length>0&&(d.newUser.first_name=e[0]),e.length>1&&(d.newUser.surname=e[1])}d.creatingNewAccount=!0},d.registerNewUser=function(e){n.register(d.newUser,!0).then(function(e){d.creatingNewAccount=!1,d.walkInStudentSelected=e},function(t){o.applyServerSideErrors(e,t),a.warning("Register failed")})},d.cancelNewAccount=function(){d.creatingNewAccount=!1,d.newUser={}},d.purchaseNewPass=function(e,n){t.purchaseNewPass(e,n).then(function(){a.success(e.full_name+" purchased a new pass!")},function(){a.error("Problem purchasing pass...")})},d.passPaidFor=function(e,n){t.passPaidFor(e).then(function(){a.success("Pass paid for")},function(){a.error("Problem paying for pass...")})},i()}angular.module("app.classCheckIn").controller("ClassCheckIn",e),e.$inject=["$q","classCheckInService","registerUserService","blockEnrolmentService","logger","validationService","manageClassesService"]}(),function(){"use strict";function e(e,t,n,r,a,o,s){function i(){return e(function(e,r){n.getClass(t.id).then(function(t){e(t)},function(e){404===e.status&&(e.displayMessage="Class does not exist..."),r(e)})})}function c(){}function u(){return e(function(r,a){var o=[],s=[],i=n.getClassRegisteredStudents(t.id).then(function(e){o=e}),u=n.getClassAttendance(t.id).then(function(e){s=e});e.all([i["catch"](c),u["catch"](c)]).then(function(){s.forEach(function(e){e.attendedClass=!0}),o.forEach(function(e){0===s.filter(function(t){return t.id===e.id}).length&&s.push(e)}),r(s)})})}function l(t){return e(function(e,r){var a=[{field:"fullname",condition:"cont",value:t},{field:"orderby",condition:"fullname"}];n.searchForUserNew(a).then(function(t){e(t.data)},function(e){404===e.status&&(e.displayMessage="No students registered..."),r(e)})})}function d(n){return e(function(e,o){var i,c;if(n.attendedClass){if(!n.passes.some(s.isValidPass))return o(n.full_name+" needs to buy a pass before attending class"),void(n.attendedClass=!1);if(!n.passes.some(s.isPaidPass))return o(n.full_name+" needs to pay for a pass before attending class"),void(n.attendedClass=!1);c={success:"Recorded student's attendance",error:"Issue recording student's attendance..."},i=r.studentAttendedClass(t.id,n.id)}else c={success:"Removed student's attendance",error:"Issue removing student's attendance..."},i=a.studentUnattendedClass(t.id,n.id);i.then(function(){g(n)}).then(function(){e(c.success)},function(){n.attendedClass=!1,o(c.error)})})}function f(t,n){return e(function(e,a){var o={user_id:t,block_ids:[n]};r.enrolInBlock(o).then(e,a)})}function g(t){return e(function(e,r){n.getUserCurrentPasses(t.id).then(function(n){t.passes=n,e()},function(){t.passes=[],e()})})}function p(t,n){return e(function(e,a){var o={payment_status:"paid"};r.assignPassToStudent(t.id,n.id,o).then(function(){g(t).then(e,e)},a)})}function v(t){return e(function(e,n){t.payment_status="paid",r.updatePass(t).then(e,function(){t.payment_status="pending",n()})})}var m={getClass:i,getStudents:u,searchUsers:l,attendenceStatusChanged:d,enrolStudent:f,getPassesForStudent:g,purchaseNewPass:p,passPaidFor:v};return m}angular.module("app.classCheckIn").factory("classCheckInService",e),e.$inject=["$q","$routeParams","dataservice","dataUpdateService","dataDeleteService","logger","commonFunctions"]}(),function(){"use strict";function e(e,t,n,r,a){function o(){var e=n.get("authuser");void 0!==e&&(f=e);var t=n.get("authdata");void 0!==t&&l(t)}function s(e){return f.claims?f.claims.filter(function(t){return t===e}).length>0:!1}function i(){return f}function c(e,t){f[e]=t,n.put("authuser",f)}function u(t,o){var s=r.encode(t+":"+o);return l(s),e(function(e,r){a.getCurrentUser().then(function(r){a.getCurrentUserClaims().then(function(a){f.isLoggedIn=!0,f.username=t,f.userId=r.id,f.name=r.full_name,f.claims=a,n.put("authdata",s),n.put("authuser",f),e()},function(){f.isLoggedIn=!0,f.username=t,f.userId=r.id,f.name=r.full_name,f.claims=[],e()})},function(e){d(),401===e.status&&r([{property_name:"global",error_message:"Invalid email or password"}])})})}function l(e){t.defaults.headers.common.Authorization="Basic "+e}function d(){document.execCommand("ClearAuthenticationCache"),n.remove("authdata"),n.remove("authuser"),t.defaults.headers.common.Authorization="Basic ",f={isLoggedIn:!1}}var f={isLoggedIn:!1},g={login:u,logout:d,getUserIdentity:i,setUserIdentityProperty:c,hasClaim:s};return o(),g}angular.module("app.core").factory("authService",e),e.$inject=["$q","$http","$cookieStore","base64Service","dataservice"]}(),function(){"use strict";function e(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";return{encode:function(t){var n,r,a,o,s,i="",c="",u="",l=0;do n=t.charCodeAt(l++),r=t.charCodeAt(l++),c=t.charCodeAt(l++),a=n>>2,o=(3&n)<<4|r>>4,s=(15&r)<<2|c>>6,u=63&c,isNaN(r)?s=u=64:isNaN(c)&&(u=64),i=i+e.charAt(a)+e.charAt(o)+e.charAt(s)+e.charAt(u),n=r=c="",a=o=s=u="";while(l<t.length);return i},decode:function(t){var n,r,a,o,s,i="",c="",u="",l=0,d=/[^A-Za-z0-9\+\/\=]/g;d.exec(t)&&alert("There were invalid base64 characters in the input text.\nValid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='\nExpect errors in decoding."),t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");do a=e.indexOf(t.charAt(l++)),o=e.indexOf(t.charAt(l++)),s=e.indexOf(t.charAt(l++)),u=e.indexOf(t.charAt(l++)),n=a<<2|o>>4,r=(15&o)<<4|s>>2,c=(3&s)<<6|u,i+=String.fromCharCode(n),64!=s&&(i+=String.fromCharCode(r)),64!=u&&(i+=String.fromCharCode(c)),n=r=c="",a=o=s=u="";while(l<t.length);return i}}}angular.module("app.core").factory("base64Service",e),e.$inject=[]}(),function(){"use strict";function e(){var e={template:"{{display}}",scope:{ngModel:"="},link:function(e,t,n,r){if("from now"===n.format)return void(e.display=moment(e.ngModel).utc().fromNow());var a="";"time"===n.format?a="h:mmA":"long date"===n.format?a="dddd MMMM D":"short date"===n.format?a="DD/MM":"time and day"===n.format&&(a="dddd h:mmA"),e.display=moment(e.ngModel).utc().format(a)}};return e}function t(e){var t={template:'<span class="label label-{{labelClass}} cursor">{{message}}</span>',require:"ngModel",scope:{ngModel:"="},link:function(t,n,r){t.$watch("ngModel",function(n){var r=t.ngModel;if(r.attendedClass)t.message="all good",t.labelClass="success";else if(r.passes.some(e.isValidPass)){var a=r.passes.filter(function(e){return"pending"===e.payment_status.toLowerCase()}).length>0;a?(t.message="pass needs payment",t.labelClass="warning"):(t.message="all good",t.labelClass="success")}else t.message="no valid passes",t.labelClass="danger"},!0)}};return t}function n(){var e={template:"{{passTypeText}} - {{passNumber}} - {{validnessText}}",require:"ngModel",scope:{ngModel:"="},link:function(e,t,n){e.passType=e.ngModel.pass_type,e.paymentStatus=e.ngModel.payment_status,e.validness=e.ngModel.valid,e.passNumber=e.ngModel.pass_number,e.passTypeText=u(e.ngModel.pass_type),e.validnessText=l(e.ngModel)}};return e}function r(){var e={template:'<span class="help-block has-error"><div ng-show="ngModel.$error[error] && ngModel.$touched">{{message}}</div></span>',require:"ngModel",scope:{ngModel:"="},link:function(e,t,n){e.message=n.message,e.error=n.error}};return e}function a(){var e={template:'<span class="help-block has-error"  ng-show="ngModel.serverError && ngModel.$touched"><div>{{ngModel.serverError}}</div></span>',require:"ngModel",scope:{ngModel:"="},link:function(e,t,n){}};return e}function o(){var e={template:'<div class="form-group col-xs-12" ng-class="{&apos;has-error&apos;:(getFormElement().$invalid && getFormElement().$touched) || getFormElement().serverError}"><label ng-show="displayName">{{displayName}}</label><input class="form-control"id="{{name}}"name="{{name}}"type="{{type}}"placeholder="{{displayName}}"ng-model="ngModel"required="{{required}}"/><span class="help-block has-error">    <span ng-show="hasError(&apos;required&apos;) && getFormElement().$touched">{{displayName}} is required.</span></span></div>',require:["^form","ngModel"],scope:{ngModel:"="},link:function(e,t,n,r){e.name=n.name,e.label=n.label,e.displayName=n.displayName,e.type=n.type,e.required=n.required,e.form=r[0],e.formElement=r[0][n.name],e.getFormElement=function(){return r[0][n.name]},e.hasError=function(t){return e.getFormElement().$error[t]}}};return e}function s(){var e={template:'<div class="form-group col-xs-12" ng-class="{&apos;has-error&apos;:(getFormElement().$invalid && getFormElement().$touched) || getFormElement().serverError}"><label ng-show="displayName">{{displayName}}</label><datetimepicker show-weeks="false" hour-step="1" minute-step="15" ng-model="ngModel" show-meridian="false" date-format="dd-MMM-yyyy" readonly-time="false"></datetimepicker><span class="help-block has-error">    <span ng-show="hasError(&apos;required&apos;) && getFormElement().$touched">{{displayName}} is required.</span></span></div>',require:["^form","ngModel"],scope:{ngModel:"="},link:function(e,t,n,r){e.name=n.name,e.displayName=n.displayName,e.type=n.type,e.required=n.required,e.form=r[0],e.formElement=r[0][n.name],e.getFormElement=function(){return r[0][n.name]},e.hasError=function(t){return e.getFormElement().$error[t]}}};return e}function i(e,t){var n={template:'<input type="text" placeholder="{{placeholder}}" ng-model="ngModel" typeahead="student as student.full_name for student in searchUsers($viewValue)">',require:["ngModel"],scope:{ngModel:"="},link:function(n,r,a){n.placeholder=a.placeholder,n.searchUsers=function(n){return t(function(t,r){var a=[{field:"fullname",condition:"cont",value:n},{field:"orderby",condition:"fullname"}];e.searchForUserNew(a).then(function(e){t(e.data)},function(e){404===e.status&&(e.displayMessage="No users found..."),r(e)})})}}};return n}function c(e){var t={template:'<div class="form-group col-xs-12"><select ng-options="teacher as teacher.full_name for teacher in teachers track by teacher.id" ng-model="ngModel[0]">    <option value="">Please select the primary teacher</option></select></div><div class="form-group col-xs-12"><select ng-options="teacher as teacher.full_name for teacher in teachers track by teacher.id" ng-model="ngModel[1]">    <option value="">Please select the secondary teacher (optional)</option></select></div>',require:["ngModel"],scope:{ngModel:"="},link:function(t,n,r){t.teachers=[],e.getAllTeachers().then(function(e){t.teachers=e}),t.ngModel&&t.ngModel instanceof Array||(t.ngModel=[])}};return t}function u(e){var t=e.toLowerCase();return"clip"===t?"Clip pass":"single"===t?"Single pass":"unlimited"===t?"Unlimited pass":void 0}function l(e){var t="";return"unlimited"!==e.pass_type.toLowerCase()&&(t=e.clips_remaining+" clip",e.clips_remaining>1&&(t+="s"),t+=" remaining, and "),t=t+"expires on the "+moment(e.end_date).format("dddd MMMM D")}angular.module("app.core").directive("displayDate",e).directive("passStatus",t).directive("passSummary",n).directive("validationError",r).directive("serverError",a).directive("commonInput",o).directive("commonDateTimeInput",s).directive("userSearch",i).directive("teacherDropdown",c)}(),function(){"use strict";function e(){function e(e){return e.valid}function t(e){return e.payment_status&&"paid"===e.payment_status.toLowerCase()}var n={isValidPass:e,isPaidPass:t};return n}Array.prototype.any||(Array.prototype.any=function(){return this.length>0}),Array.prototype.remove||(Array.prototype.remove=function(e){var t=this.indexOf(e);t>-1&&this.splice(t,1)}),Array.prototype.getFirstOrDefault||(Array.prototype.getFirstOrDefault=function(e,t){var n=this.filter(function(n){return n[e]===t})[0];return n}),angular.module("app.core").factory("commonFunctions",e),e.$inject=[]}(),function(){"use strict";function e(e){e.options.timeOut=4e3,e.options.positionClass="toast-bottom-right"}function t(e,t,n,a){e.debugEnabled&&e.debugEnabled(!0),n.config.$routeProvider=t,n.config.docTitle="Speedy Donkey LOCAL: ",a.config.appErrorPrefix=r.appErrorPrefix}var n=angular.module("app.core");n.config(e);var r={appErrorPrefix:"[Speedy Donkey LOCAL Error] ",appTitle:"Speedy Donkey LOCAL",apiUrl:"api-speedydonkey.azurewebsites.net",version:"3.0.0"};n.value("config",r),n.config(t)}(),function(){"use strict";angular.module("app.core").constant("toastr",toastr).constant("moment",moment)}(),function(){"use strict";function e(e,t,n,r){function a(n){return e(function(e,r){t.postUser(n).success(function(t){e(t.action_result)}).error(function(e){r(e)})})}function o(n){return e(function(e,r){t.postPassOption(n).success(function(t){e(t.action_result)}).error(function(e){r(e)})})}function s(n){return e(function(e,r){t.postLevel(n).success(function(t){e(t.action_result)}).error(function(e){r(e)})})}function i(n){return e(function(e,r){t.postBlock(n).success(function(t){e(t.action_result)}).error(function(e){r(e)})})}function c(n){return e(function(e,r){t.postTeacher(n).success(function(t){e(t.action_result)}).error(function(e){r(e)})})}var u={createUser:a,createPassOption:o,createLevel:s,createBlock:i,createTeacher:c};return u}angular.module("app.core").factory("dataCreateService",e),e.$inject=["$q","apiCaller","authService","dateService"]}(),function(){"use strict";function e(e,t){function n(n,r){return e(function(e,a){t.deleteClassAttendance(n,r).then(e,a)})}function r(n){return e(function(e,r){t.deletePassOption(n).then(e,r)})}function a(n){return e(function(e,r){t.deleteLevel(n).then(e,r)})}function o(n){return e(function(e,r){t.deleteBlock(n).then(e,r)})}function s(n){return e(function(e,r){t.deleteClass(n).then(e,r)})}function i(n){return e(function(e,r){t.deleteTeacher(n).then(e,r)})}function c(n){return e(function(e,r){t.deleteUser(n).then(e,r)})}function u(n){return e(function(e,r){t.deletePass(n).then(e,r)})}var l={studentUnattendedClass:n,deletePassOption:r,deleteLevel:a,deleteBlock:o,deleteClass:s,deleteTeacher:i,deleteUser:c,deletePass:u};return l}angular.module("app.core").factory("dataDeleteService",e),e.$inject=["$q","apiCaller"]}(),function(){"use strict";function e(e,t){function n(n){return e(function(e,r){t.postUserActivation(n).then(function(t){e()},function(){r()})})}function r(n){return e(function(e,r){t.postUserPasswordReset(n).then(function(t){e()},function(){r()})})}function a(n,r){return e(function(e,a){t.putUserPasswordReset(n,r).then(function(t){e()},function(e){a(e.data.validation_errors)})})}function o(n){return e(function(e,r){t.putCurrentUser(n).then(function(t){e()},function(e){r(e.data.validation_errors)})})}function s(n){return e(function(e,r){t.postBlockEnrolment(n).then(function(t){e()},function(){r()})})}function i(n,r){return e(function(e,a){t.postClassAttendance(n,r).then(e,a)})}function c(n,r,a){return e(function(e,o){t.postPassAssignment(n,r,a).then(e,o)})}function u(n,r){return e(function(e,a){t.postCurrentUserPassAssignment(n,r).then(e,a)})}function l(n){return e(function(e,r){t.putPass(n).then(e,r)})}function d(n){return e(function(e,r){t.putPassOption(n).then(e,r)})}function f(n){return e(function(e,r){t.putLevel(n).then(e,r)})}function g(n){return e(function(e,r){t.putBlock(n).then(e,r)})}function p(n){return e(function(e,r){t.putClass(n).then(e,r)})}var v={activateUser:n,forgottenPassword:r,resetPassword:a,updateUser:o,enrolInBlock:s,studentAttendedClass:i,assignPassToStudent:c,assignPassToCurrentUser:u,updatePass:l,updatePassOption:d,updateLevel:f,updateBlock:g,updateClass:p};return v}angular.module("app.core").factory("dataUpdateService",e),e.$inject=["$q","apiCaller"]}(),function(){"use strict";function e(e,t,n){function r(n){return e(function(e,r){t.getUser(n).then(function(t){e(t.data)},r)})}function a(e){var n="";for(var r in e)e.hasOwnProperty(r)&&(n=n+"&"+r+"_=_"+e[r]);return n=n.slice(1),t.searchUser(n)}function o(e){var n="";return e.forEach(function(e,t){t>0&&(n+=","),n=n+e.field+"_"+e.condition,e.value&&(n=n+"_"+e.value)}),t.searchUser(n)}function s(){return e(function(e,n){t.getCurrentUser().then(function(t){e(t.data)},n)})}function i(){return e(function(e,n){t.getUsers().then(function(t){e(t.data)},n)})}function c(){return e(function(e,n){t.getCurrentUserSchedule().then(function(t){e(t.data)},function(e){n(e)})})}function u(){return l("current")}function l(n){return e(function(e,r){t.getUserCurrentPasses(n).then(function(t){e(t.data)},function(e){r(e)})})}function d(){return e(function(e,n){t.getUserEnroledBlocks().then(function(t){e(t.data)},function(e){n(e)})})}function f(){return e(function(e,n){t.getCurrentUserClaims().then(function(t){e(t.data)},function(e){n(e)})})}function g(){return e(function(e,n){t.getBlock().then(function(t){e(t.data)},function(e){n(e)})})}function p(){return e(function(e,n){var r=moment().format("YYYY-MM-DD");t.searchBlock("endDate_gt_"+r).then(function(t){e(t.data)},function(e){n(e)})})}function v(n){return e(function(e,r){t.getClass(n).then(function(t){e(t.data)},r)})}function m(e){var n="";return e.forEach(function(e,t){t>0&&(n+=","),n=n+e.field+"_"+e.condition+"_"+e.value}),t.searchClass(n)}function h(n){return e(function(e,r){t.getClassRegisteredStudents(n).then(function(t){e(t.data)},function(e){r(e)})})}function S(n){return e(function(e,r){t.getClassAttendance(n).then(function(t){e(t.data)},function(e){r(e)})})}function y(){return e(function(e,n){t.getPassOption().then(function(t){e(t.data)},function(e){n(e)})})}function C(){return e(function(e,n){t.getLevel().then(function(t){e(t.data)},function(e){n(e)})})}function k(){return e(function(e,n){var r=moment().format("YYYY-MM-DD"),a=moment().add("days",7).format("YYYY-MM-DD");t.searchClass("endTime_gt_"+r+",endTime_lt_"+a+",orderby_starttime").then(function(t){e(t.data)},function(e){n(e)})})}function U(){return e(function(e,n){t.getTeacher().then(function(t){e(t.data)},function(e){n(e)})})}function P(n,r){return e(function(e,a){t.getProfitReport(n,r).then(function(t){e(t.data)},function(e){a(e)})})}var w={getUser:r,searchForUser:a,searchForUserNew:o,getCurrentUser:s,getAllUsers:i,getCurrentUserSchedule:c,getCurrentUserCurrentPasses:u,getUserCurrentPasses:l,getUserEnroledBlocks:d,getCurrentUserClaims:f,getAllBlocks:g,getAllActiveBlocks:p,getClass:v,searchForClasses:m,getClassRegisteredStudents:h,getClassAttendance:S,getAllPassOptions:y,getAllLevels:C,getAllActiveClasses:k,getAllTeachers:U,getProfitReport:P};return w}angular.module("app.core").factory("dataservice",e),e.$inject=["$q","apiCaller","dateService"]}(),function(){"use strict";function e(){function e(r){if(n(r))r.forEach(function(t){e(t)});else for(var a in r)if(r.hasOwnProperty(a))if(t(a)){var o=r[a],s=new Date(o);r[a]=s}else"object"==typeof r[a]&&e(r[a])}var r={convertStringsToDates:e};return r}function t(e){return e.toLowerCase().indexOf("date")>-1||e.toLowerCase().indexOf("time")>-1}function n(e){return Array.isArray?Array.isArray(e):e instanceof Array}angular.module("app.core").factory("dateService",e),e.$inject=[]}(),function(){"use strict";function e(){function e(){return[{display:"Clip",value:"clip"},{display:"Unlimited",value:"unlimited"}]}var t={getPassTypes:e};return t}angular.module("app.core").factory("selectOptionService",e),e.$inject=[]}(),function(){"use strict";function e(){function e(e,t){t&&(e.serverErrors=[],t.forEach(function(t){var n=e[t.property_name.toLowerCase()];n?e[t.property_name.toLowerCase()].serverError=t.error_message:e.serverErrors.push(t.error_message)}))}var t={applyServerSideErrors:e};return t}angular.module("app.core").factory("validationService",e),e.$inject=[]}(),function(){"use strict";function e(e,t,n,r,a){function o(){var t=[s(),i(),c()];return e.all(t).then(function(){n.info("Activated Dashboard View")})}function s(){return t.getSchedule().then(function(e){u.upcomingSchedule=e,u.isScheduleLoading=!1},function(e){e.displayMessage||(e.displayMessage="Issue getting schedule..."),n.error(e.displayMessage),u.isScheduleLoading=!1})}function i(){return t.getCurrentPasses().then(function(e){u.currentPasses=e,u.arePassesLoading=!1},function(e){e.displayMessage||(e.displayMessage="Issue getting passes..."),n.error(e.displayMessage),u.arePassesLoading=!1})}function c(){return u.canPerformClassCheckIn?t.getClassesForCheckIn().then(function(e){u.todaysClasses=e,u.areClassesLoading=!1},function(e){e.displayMessage||(e.displayMessage="Issue getting classes for check in..."),n.error(e.displayMessage),u.areClassesLoading=!1}):e.when()}var u=this;u.upcomingSchedule=[],u.currentPasses=[],u.todaysClasses=[],u.isScheduleLoading=!0,u.arePassesLoading=!0,u.areClassesLoading=!0,u.canPerformClassCheckIn=r.hasClaim("Teacher"),u.companyName=a.appTitle,o()}angular.module("app.dashboard").controller("Dashboard",e),e.$inject=["$q","dashboardService","logger","authService","config"]}(),function(){"use strict";function e(e,t,n,r){function a(){return e(function(e,n){t.getCurrentUserSchedule().then(function(t){e(t)},function(e){404===e.status&&(e.displayMessage="Nothing scheduled yet..."),n(e)})})}function o(){return e(function(e,n){t.getCurrentUserCurrentPasses().then(function(t){e(t)},function(e){404===e.status&&(e.displayMessage="No current passes..."),n(e)})})}function s(){return e(function(e,n){var r=[{field:"starttime",condition:"gt",value:moment().format("YYYY-MM-DD")},{field:"starttime",condition:"lt",value:moment().add(1,"day").format("YYYY-MM-DD")}];t.searchForClasses(r).then(function(t){e(t.data)},function(e){404===e.status&&(e.displayMessage="No classes for today..."),n(e)})})}var i={getSchedule:a,getCurrentPasses:o,getClassesForCheckIn:s};return i}angular.module("app.dashboard").factory("dashboardService",e),e.$inject=["$q","dataservice","logger","authService"]}(),function(){"use strict";function e(e,t,n){function r(){e.info("Activated Forgotten Password View")}var a=this;a.title="Forgotten Password",a.isSubmitted=!1,a.submit=function(e){t.forgottenPassword(a.email).then(function(){a.isSubmitted=!0})},r()}angular.module("app.forgottenPassword").controller("ForgottenPassword",e),e.$inject=["logger","dataUpdateService","validationService"]}(),function(){"use strict";function e(e,t,n,r,a){function o(){n.success(t.appTitle+" loaded!",null),s()}function s(){e(function(){i.showSplash=!1},1e3)}var i=this;i.title=t.appTitle,i.busyMessage="Please wait ...",i.isBusy=!0,i.showSplash=!0,i.getUserIdentity=r.getUserIdentity,i.loginUrl="#/login",i.registerUrl="#/register/user",i.manageUserUrl="#/manageUser",i.logout=function(){r.logout(),a.redirectToRoute("login")},o()}angular.module("app.layout").controller("Shell",e),e.$inject=["$timeout","config","logger","authService","routehelper"]}(),function(){"use strict";function e(e,t){function n(){r()}function r(){o.navRoutes=s.filter(function(e){return e.settings&&e.settings.nav}).sort(function(e,t){return e.settings.nav-t.settings.nav})}function a(t){if(!t.title||!e.current||!e.current.title)return"";var n=t.title;return e.current.title.substr(0,n.length)===n?"current":""}var o=this,s=t.getRoutes();o.isCurrent=a,n()}angular.module("app.layout").controller("Sidebar",e).filter("authorisedLink",function(e){}),e.$inject=["$route","routehelper"]}(),function(){"use strict";function e(e,t,n,r,a){function o(){e.info("Activated Login View")}var s=this;s.title="Login",s.forgottenPasswordUrl="#/forgottenPassword",s.registerUrl="#/register/user",s.company=a.appTitle,s.submit=function(e){t.login(s.email,s.password).then(function(){n.redirectToRoute("dashboard")},function(t){r.applyServerSideErrors(e,t)})},o()}angular.module("app.logon").controller("Login",e),e.$inject=["logger","authService","routehelper","validationService","config"]}(),function(){"use strict";function e(e,t,n){function r(){var n=[a()];return e.all(n).then(function(){t.info("Activated Manage Blocks")})}function a(){n.getBlocks().then(function(e){o.blocks=e},function(){t.error("Failed to get blocks")})}var o=this;o.blocks=[],r()}function t(e,t,n,r){e.vm.submitText="Update",e.vm.cancelText="Close";var a={};e.vm.startUpdating=function(){a=angular.copy(e.vm.block),e.vm.updating=!0},e.vm.submit=function(a){t.update(e.vm.block).then(function(){r.success("Block updated"),e.vm.updating=!1},function(e){n.applyServerSideErrors(a,e)})},e.vm["delete"]=function(){t.deleteBlock(e.vm.block.id).then(function(){r.success("Block deleted"),e.$parent.vm.blocks.remove(e.vm.block)},function(e){r.error("Failed to delete block")})},e.vm.cancel=function(){e.vm.block=a,e.vm.updating=!1,e.form.$setUntouched()}}angular.module("app.manageBlocks").controller("ManageBlocks",e).controller("ManageBlock",t),e.$inject=["$q","logger","manageBlocksService"],t.$inject=["$scope","manageBlocksService","validationService","logger"]}(),function(){"use strict";function e(e,t,n,r,a,o){function s(t){return e(function(e,n){r.updateBlock(t).then(function(t){e(t)},function(e){void 0!==e.validation_result?n(e.validation_result.validation_errors):n()})})}function i(){return e(function(e,t){n.getAllActiveBlocks().then(function(t){e(t)},t)})}function c(t){return e(function(e,n){o.deleteBlock(t).then(e,n)})}var u={update:s,getBlocks:i,deleteBlock:c};return u}angular.module("app.manageBlocks").factory("manageBlocksService",e),e.$inject=["$q","logger","dataservice","dataUpdateService","dataCreateService","dataDeleteService"]}(),function(){"use strict";function e(e,t,n){function r(){var n=[a()];return e.all(n).then(function(){t.info("Activated Manage Classes")})}function a(){n.getClasses().then(function(e){o.classes=e},function(){t.error("Failed to get classes")})}var o=this;o.classes=[],r()}function t(e,t,n,r){e.vm.submitText="Update",e.vm.cancelText="Close";var a={};e.vm.startUpdating=function(){a=angular.copy(e.vm["class"]),e.vm.updating=!0},e.vm.submit=function(a){t.update(e.vm["class"]).then(function(){r.success("Class updated"),e.vm.updating=!1},function(e){n.applyServerSideErrors(a,e)})},e.vm["delete"]=function(){t.deleteClass(e.vm["class"].id).then(function(){r.success("Class deleted"),e.$parent.vm.classes.remove(e.vm["class"])},function(e){r.error("Failed to delete class")})},e.vm.cancel=function(){e.vm["class"]=a,e.vm.updating=!1,e.form.$setUntouched()}}angular.module("app.manageClasses").controller("ManageClasses",e).controller("ManageClass",t),
e.$inject=["$q","logger","manageClassesService"],t.$inject=["$scope","manageClassesService","validationService","logger"]}(),function(){"use strict";function e(e,t,n,r,a,o){function s(t){return e(function(e,n){r.updateClass(t).then(function(t){e(t)},function(e){void 0!==e.validation_result?n(e.validation_result.validation_errors):n()})})}function i(){return e(function(e,t){n.getAllActiveClasses().then(function(t){t.forEach(function(e){e.block=void 0}),e(t)},t)})}function c(t){return e(function(e,n){o.deleteClass(t).then(e,n)})}var u={update:s,getClasses:i,deleteClass:c};return u}angular.module("app.manageClasses").factory("manageClassesService",e),e.$inject=["$q","logger","dataservice","dataUpdateService","dataCreateService","dataDeleteService"]}(),function(){"use strict";function e(e,t,n){function r(){var n=[a()];return e.all(n).then(function(){t.info("Activated Manage Levels")})}function a(){n.getLevels().then(function(e){o.levels=e},function(){t.error("Failed to get levels")})}var o=this;o.levels=[],o.generateForAllLevels=function(){n.generateAllBlocks().then(function(){t.success("All blocks generated")},function(){t.error("Problem generating blocks")})},r()}function t(e,t,n,r){e.vm={},e.vm.submitText="Add",e.vm.cancelText="Cancel",e.vm.level={teachers:[]},e.vm.submit=function(a){t.create(e.vm.level).then(function(t){r.success("New level created"),e.$parent.vm.levels.push(t),e.vm.addingNew=!1,e.vm.level={teachers:[]},e.form.$setUntouched()},function(e){n.applyServerSideErrors(a,e)})},e.vm.cancel=function(){e.vm.addingNew=!1,e.vm.level={},e.form.$setUntouched()}}function n(e,t,n,r){e.vm.submitText="Update",e.vm.cancelText="Close";var a={};e.vm.startUpdating=function(){a=angular.copy(e.vm.level),e.vm.updating=!0},e.vm.submit=function(a){t.update(e.vm.level).then(function(){r.success("Level updated"),e.vm.updating=!1},function(e){n.applyServerSideErrors(a,e)})},e.vm.generateBlock=function(){t.generateBlock(e.vm.level.id).then(function(){r.success("Block generated")},function(){r.error("Problem generating block")})},e.vm["delete"]=function(){t.deleteLevel(e.vm.level.id).then(function(){r.success("Level deleted"),e.$parent.vm.levels.remove(e.vm.level)},function(e){r.error("Failed to delete level")})},e.vm.cancel=function(){e.vm.level=a,e.vm.updating=!1,e.form.$setUntouched()}}angular.module("app.manageLevels").controller("ManageLevels",e).controller("NewLevel",t).controller("ManageLevel",n),e.$inject=["$q","logger","manageLevelsService"],t.$inject=["$scope","manageLevelsService","validationService","logger"],n.$inject=["$scope","manageLevelsService","validationService","logger"]}(),function(){"use strict";function e(e,t,n,r,a,o){function s(t){return e(function(e,n){a.createLevel(t).then(function(t){e(t)},function(e){void 0!==e.validation_result?n(e.validation_result.validation_errors):n()})})}function i(t){return e(function(e,n){r.updateLevel(t).then(function(t){e(t)},function(e){void 0!==e.validation_result?n(e.validation_result.validation_errors):n()})})}function c(){return e(function(e,t){n.getAllLevels().then(function(t){e(t)},t)})}function u(t){return e(function(e,n){a.createBlock(t).then(e,n)})}function l(){return u("all")}function d(t){return e(function(e,n){o.deleteLevel(t).then(e,n)})}var f={create:s,update:i,getLevels:c,generateBlock:u,generateAllBlocks:l,deleteLevel:d};return f}angular.module("app.manageLevels").factory("manageLevelsService",e),e.$inject=["$q","logger","dataservice","dataUpdateService","dataCreateService","dataDeleteService"]}(),function(){"use strict";function e(e,t,n,r){function a(){var n=[o(),s()];return e.all(n).then(function(){t.info("Activated Manage Pass Options")})}function o(){e(function(e){i.passTypes=n.getPassTypes(),e()})}function s(){r.getPassOptions().then(function(e){i.passOptions=e},function(){t.error("Failed to get pass options")})}var i=this;i.passTypes=[],i.passOptions=[],a()}function t(e,t,n,r){e.vm={},e.vm.passTypes=e.$parent.vm.passTypes,e.vm.submitText="Add",e.vm.cancelText="Cancel",e.vm.submit=function(a){t.create(e.vm.passOption).then(function(t){r.success("New pass option created"),e.$parent.vm.passOptions.push(t),e.vm.addingNew=!1,e.vm.passOption={},e.form.$setUntouched()},function(e){n.applyServerSideErrors(a,e)})},e.vm.cancel=function(){e.vm.addingNew=!1,e.vm.passOption={},e.form.$setUntouched()}}function n(e,t,n,r){e.vm.passTypes=e.$parent.vm.passTypes,e.vm.submitText="Update",e.vm.cancelText="Cancel";var a={};e.vm.startUpdating=function(){a=angular.copy(e.vm.passOption),e.vm.updating=!0},e.vm.submit=function(a){t.update(e.vm.passOption).then(function(t){r.success("Pass option updated"),e.vm.updating=!1},function(e){n.applyServerSideErrors(a,e)})},e.vm["delete"]=function(){t.deletePassOption(e.vm.passOption.id).then(function(){r.success("Pass option deleted"),e.$parent.vm.passOptions.remove(e.vm.passOption)},function(e){r.error("Failed to delete pass option")})},e.vm.cancel=function(){e.vm.passOption=a,e.vm.updating=!1,e.form.$setUntouched()}}angular.module("app.managePassOptions").controller("ManagePassOptions",e).controller("NewPassOptions",t).controller("UpdatePassOptions",n),e.$inject=["$q","logger","selectOptionService","managePassOptionsService"],t.$inject=["$scope","managePassOptionsService","validationService","logger"],n.$inject=["$scope","managePassOptionsService","validationService","logger"]}(),function(){"use strict";function e(e,t,n,r,a,o){function s(t){return e(function(e,n){a.createPassOption(t).then(function(t){e(t)},function(e){void 0!==e.validation_result?n(e.validation_result.validation_errors):n()})})}function i(t){return e(function(e,n){r.updatePassOption(t).then(function(t){e(t)},function(e){void 0!==e.validation_result?n(e.validation_result.validation_errors):n()})})}function c(t){return e(function(e,n){o.deletePassOption(t).then(e,n)})}function u(){return e(function(e,t){n.getAllPassOptions().then(function(t){e(t)},t)})}var l={create:s,update:i,deletePassOption:c,getPassOptions:u};return l}angular.module("app.managePassOptions").factory("managePassOptionsService",e),e.$inject=["$q","logger","dataservice","dataUpdateService","dataCreateService","dataDeleteService"]}(),function(){"use strict";function e(e,t,n){function r(){var n=[a()];return e.all(n).then(function(){t.info("Activated Manage Students")})}function a(){e(function(e){n.getStudents().then(function(t){o.students=t,e()},function(){t.error("Failed getting students")})})}var o=this;o.students=[],o.remove=function(e){n.deleteStudent(e).then(function(){var n=o.students.filter(function(t){return t.id===e})[0];t.success(n.full_name+" has been removed as a student"),o.students.remove(n)},function(){t.error("Failed removing the student")})},o.getStudentInfo=function(e){void 0===e.studentInfo&&n.getStudentInfo(e.id).then(function(t){e.studentInfo=t}),e.show=!e.show},o.deletePass=function(e,r){n.deletePass(r.id).then(function(){e.studentInfo.passes.remove(r),t.success("Pass deleted")},function(){t.error("Problem deleting pass")})},r()}angular.module("app.manageStudents").controller("ManageStudents",e),e.$inject=["$q","logger","manageStudentsService"]}(),function(){"use strict";function e(e,t,n,r,a){function o(t){return e(function(e,n){a.deleteUser(t).then(e,n)})}function s(){return e(function(e,t){n.getAllUsers().then(function(t){e(t)},t)})}function i(t){return e(function(e,r){n.getUserCurrentPasses(t).then(function(t){e({passes:t})},function(){e({passes:[]})})})}function c(t){return e(function(e,n){a.deletePass(t).then(e,n)})}var u={deleteStudent:o,getStudents:s,getStudentInfo:i,deletePass:c};return u}angular.module("app.manageStudents").factory("manageStudentsService",e),e.$inject=["$q","logger","dataservice","dataCreateService","dataDeleteService"]}(),function(){"use strict";function e(e,t,n){function r(){var n=[a()];return e.all(n).then(function(){t.info("Activated Manage Teachers")})}function a(){e(function(e){n.getTeachers().then(function(t){o.teachers=t,e()},function(){t.error("Failed getting teachers")})})}var o=this;o.teachers=[],o.addTeacher=function(){n.addTeacher(o.selectedUser.id).then(function(e){t.success(e.full_name+" is now a teacher!"),o.teachers.push(e),o.selectedUser=""},function(){t.error("Failed adding the new teacher")})},o.remove=function(e){n.deleteTeacher(e).then(function(){var n=o.teachers.filter(function(t){return t.id===e})[0];t.success(n.full_name+" has been removed as a teacher"),o.teachers.remove(n)},function(){t.error("Failed removing the teacher")})},r()}angular.module("app.manageTeachers").controller("ManageTeachers",e),e.$inject=["$q","logger","manageTeachersService"]}(),function(){"use strict";function e(e,t,n,r,a){function o(t){return e(function(e,n){r.createTeacher(t).then(function(t){e(t)},function(e){void 0!==e.validation_result?n(e.validation_result.validation_errors):n()})})}function s(t){return e(function(e,n){a.deleteTeacher(t).then(e,n)})}function i(){return e(function(e,t){n.getAllTeachers().then(function(t){e(t)},t)})}var c={addTeacher:o,deleteTeacher:s,getTeachers:i};return c}angular.module("app.manageTeachers").factory("manageTeachersService",e),e.$inject=["$q","logger","dataservice","dataCreateService","dataDeleteService"]}(),function(){"use strict";function e(e,t,n,r){function a(){var t=[o()];return e.all(t).then(function(){n.info("Activated Manage User")})}function o(){t.getUser().then(function(e){s.user=e})}var s=this;s.title="Update Details",s.user={},s.registrationSuccessful=!1,s.updateUser=function(e){t.updateUser(s.user).then(function(){n.success("Your details have been updated")},function(t){r.applyServerSideErrors(e,t),n.warning("Your details have not been updated")})},a()}angular.module("app.manageUser").controller("ManageUser",e),e.$inject=["$q","manageUserService","logger","validationService"]}(),function(){"use strict";function e(e,t,n,r,a){function o(){return e(function(e,t){n.getCurrentUser().then(function(t){e(t)},function(e){void 0!==e.validation_result?t(e.validation_result.validation_errors):t()})})}function s(t){return e(function(e,n){r.updateUser(t).then(function(){a.login(t.email,t.password).then(function(){e(t)})},function(e){void 0!==e.validation_result?n(e.validation_result.validation_errors):n()})})}var i={getUser:o,updateUser:s};return i}angular.module("app.manageUser").factory("manageUserService",e),e.$inject=["$q","logger","dataservice","dataUpdateService","authService"]}(),function(){"use strict";function e(e,t,n){function r(){t.info("Activated Register User View")}var a=this;a.title="Register Account",a.newUser={},a.registrationSuccessful=!1,a.registerNewUser=function(r){e.register(a.newUser).then(function(){a.registrationSuccessful=!0},function(e){n.applyServerSideErrors(r,e),t.warning("Register failed")})},r()}angular.module("app.register").controller("RegisterUser",e),e.$inject=["registerUserService","logger","validationService"]}(),function(){"use strict";function e(e,t,n,r){function a(t,r){return e(function(e,r){n.createUser(t).then(function(t){e(t)},function(e){void 0!==e.validation_result?r(e.validation_result.validation_errors):r()})})}var o={register:a};return o}angular.module("app.core").factory("registerUserService",e),e.$inject=["$q","logger","dataCreateService","authService"]}(),function(){"use strict";function e(e,t,n,r){function a(){var t=[o.updateDateRanage()];return e.all(t).then(function(){n.info("Activated Profit Report")})}var o=this;o.starting=moment().subtract(1,"month").startOf("day").format("YYYY-MM-DD"),o.ending=moment().endOf("day").add(2,"month").format("YYYY-MM-DD"),o.updateDateRanage=function(){t.getProfitReport(o.starting,o.ending).then(function(e){o.profitReport=e},function(){n.error("Issue getting profit report")})},a()}angular.module("app.reportProfit").controller("ReportProfit",e),e.$inject=["$q","reportProfitService","logger","validationService"]}(),function(){"use strict";function e(e,t){function n(n,r){return e(function(e,a){t.getProfitReport(n,r).then(function(t){e(t)},a)})}var r={getProfitReport:n};return r}angular.module("app.reportProfit").factory("reportProfitService",e),e.$inject=["$q","dataservice"]}(),function(){"use strict";function e(e,t,n,r){function a(){var t=[o.getHours()];return e.all(t).then(function(){n.info("Activated Teacher Hours Report")})}var o=this;o.teacherHours=[],o.starting=moment().subtract(1,"month").startOf("day").format("YYYY-MM-DD"),o.ending=moment().endOf("day").format("YYYY-MM-DD"),o.getHours=function(){t.getTeacherHours(o.starting,o.ending).then(function(e){o.teacherHours=e})},a()}angular.module("app.reportTeacherHours").controller("ReportTeacherHours",e),e.$inject=["$q","reportTeacherHoursService","logger","validationService"]}(),function(){"use strict";function e(e,t,n,r,a){function o(t,r){return e(function(e,a){var o=[{field:"startTime",condition:"gt",value:t},{field:"endTime",condition:"lt",value:r}];n.searchForClasses(o).then(function(t){var n=[];t.data.forEach(function(e){e.teachers.forEach(function(t){var r=n.getFirstOrDefault("id",t.id);r||(r={id:t.id,full_name:t.full_name,soloClasses:[],partnerClasses:[]},n.push(r)),1===e.teachers.length?r.soloClasses.push(e):r.partnerClasses.push(e)})}),e(n)},a)})}var s={getTeacherHours:o};return s}angular.module("app.reportTeacherHours").factory("reportTeacherHoursService",e),e.$inject=["$q","logger","dataservice","dataUpdateService","authService"]}(),function(){"use strict";function e(e,t,n,r){function a(){t.info("Activated Reset Password View")}var o=this;o.title="Reset Password",o.isSubmitted=!1,o.loginUrl="#/login",o.submit=function(a){n.resetPassword(e.id,o.password).then(function(){o.isSubmitted=!0},function(e){r.applyServerSideErrors(a,e),t.warning("Password Reset failed")})},a()}angular.module("app.resetPassword").controller("ResetPassword",e),e.$inject=["$routeParams","logger","dataUpdateService","validationService"]}(),function(){"use strict";function e(e,t,n,r){function a(){t.info("Activated User Activation View"),e.activate().then(function(){o.activationSuccessful=!0,o.loaded=!0},function(e){t.warning("Activation Failed"),o.activationSuccessful=!1,o.loaded=!0})}var o=this;o.title="User Activation",o.loginUrl="#/login",o.loaded=!1,a()}angular.module("app.userActivation").controller("UserActivation",e),e.$inject=["userActivationService","logger","routehelper","validationService"]}(),function(){"use strict";function e(e,t,n){function r(){return e(function(e,r){n.activateUser(t.key).then(e,r)})}var a={activate:r};return a}angular.module("app.userActivation").factory("userActivationService",e),e.$inject=["$q","$routeParams","dataUpdateService","authService"]}(),function(){"use strict";function e(){function e(e,t,n){function r(e){function t(){a.slideUp(350),$(".sidebar-dropdown a").removeClass(n)}var n="dropy";e.preventDefault(),o.hasClass(n)?o.hasClass(n)&&(o.removeClass(n),a.slideUp(350)):(t(),a.slideDown(350),o.addClass(n))}var a=t.find(".sidebar-inner"),o=t.find(".sidebar-dropdown a");t.addClass("sidebar"),o.click(r)}var t={link:e,restrict:"A"};return t}angular.module("app.widgets").directive("ccSidebar",e)}(),function(){"use strict";function e(e,t){function n(t){var n=G+"users/activation/"+t;return e.post(n)}function r(t){var n=G+"users/password/reset";return e.post(n,{email:t})}function a(t,n){var r=G+"users/password/reset/"+t;return e.put(r,{password:n})}function o(t){var n=G+"users";return e.post(n,t)}function s(t){var n=G+"users/current";return e.put(n,t)}function i(t){var n=G+"users/"+t;return e.get(n)}function c(){var t=G+"users";return e.get(t)}function u(t){var n=G+"users?q="+t;return e.get(n)}function l(){var t=G+"users/current";return e.get(t)}function d(t){var n=G+"users/"+t;return e["delete"](n)}function f(){var t=G+"users/current/schedules";return e.get(t)}function g(t){var n=G+"users/"+t+"/passes";return e.get(n)}function p(t){var n=G+"users/current/blocks";return e.get(n)}function v(){var t=G+"users/current/claims";return e.get(t)}function m(t,n,r){var a=G+"users/"+t+"/passtemplates/"+n;return e.post(a,r)}function h(t,n){var r=G+"users/current/passtemplates/"+t;return e.post(r,n)}function S(t){var n=G+"blocks";return void 0!==t&&null!==t&&(n=n+"/"+t),e.get(n)}function y(t){var n=G+"blocks?q="+t;return e.get(n)}function C(t){var n=G+"users/"+t.user_id+"/enrolment";return e.post(n,t)}function k(t){var n=G+"reference?q="+t;return e.get(n)}function U(t){var n=G+"classes/"+t;return e.get(n)}function P(t){var n=G+"classes?q="+t;return e.get(n)}function w(t){var n=G+"classes/"+t+"/roll";return e.get(n)}function $(t){var n=G+"classes/"+t+"/attendance";return e.get(n)}function b(t,n){var r=G+"classes/"+t+"/attendance/"+n;return e.post(r)}function M(t,n){var r=G+"classes/"+t+"/attendance/"+n;return e["delete"](r)}function A(t){var n=G+"passes/"+t.id;return e.put(n,t)}function _(t){var n=G+"passes/"+t;return e["delete"](n)}function T(t){var n=G+"passtemplate";return e.post(n,t)}function O(){var t=G+"passtemplate";return e.get(t)}function L(t){var n=G+"passtemplate/"+t;return e["delete"](n)}function E(t){var n=G+"passtemplate/"+t.id;return e.put(n,t)}function I(t){var n=G+"levels";return e.post(n,t)}function B(t){var n=G+"levels/"+t.id;return e.put(n,t)}function j(){var t=G+"levels";return e.get(t)}function D(t){var n=G+"levels/"+t;return e["delete"](n)}function q(t){var n=G+"levels/"+t+"/blocks";return e.post(n)}function x(t){var n=G+"blocks/"+t.id;return e.put(n,t)}function F(t){var n=G+"blocks/"+t;return e["delete"](n)}function N(t){var n=G+"classes/"+t.id;return e.put(n,t)}function R(t){var n=G+"classes/"+t;return e["delete"](n)}function Y(t){var n=G+"teachers/"+t;return e.post(n)}function H(){var t=G+"teachers";return e.get(t)}function V(t){var n=G+"teachers/"+t;return e["delete"](n)}function z(t,n){var r=G+"report/profit?from="+t+"&to="+n;return e.get(r)}var W={postUserActivation:n,postUserPasswordReset:r,putUserPasswordReset:a,postUser:o,putCurrentUser:s,getUser:i,getUsers:c,searchUser:u,getCurrentUser:l,deleteUser:d,getCurrentUserSchedule:f,getUserCurrentPasses:g,getUserEnroledBlocks:p,getCurrentUserClaims:v,postPassAssignment:m,postCurrentUserPassAssignment:h,getBlock:S,searchBlock:y,postBlockEnrolment:C,searchReferenceData:k,getClassRegisteredStudents:w,getClassAttendance:$,postClassAttendance:b,deleteClassAttendance:M,putPass:A,deletePass:_,postPassOption:T,getPassOption:O,deletePassOption:L,putPassOption:E,postLevel:I,putLevel:B,getLevel:j,deleteLevel:D,postBlock:q,putBlock:x,deleteBlock:F,getClass:U,searchClass:P,putClass:N,deleteClass:R,postTeacher:Y,getTeacher:H,deleteTeacher:V,getProfitReport:z},G="https://"+t.apiUrl+"/api/";return W}angular.module("app.apiCaller").factory("apiCaller",e),e.$inject=["$http","config"]}(),function(){"use strict";function e(){this.config={},this.$get=function(){return{config:this.config}}}function t(e){e.decorator("$exceptionHandler",n)}function n(e,t,n){var r=t.config.appErrorPrefix||"";return function(t,a){e(t,a);var o={exception:t,cause:a},s=r+t.message;n.error(s,o)}}angular.module("blocks.exception").provider("exceptionConfig",e).config(t),t.$inject=["$provide"],n.$inject=["$delegate","exceptionConfig","logger"]}(),function(){"use strict";function e(e){function t(t){return function(n){e.error(t,n)}}var n={catcher:t};return n}angular.module("blocks.exception").factory("exception",e)}(),function(){"use strict";function e(e,t){function n(n,r,a){t.error(n,a),e.error("Error: "+n,r)}function r(n,r,a){t.info(n,a),e.info("Info: "+n,r)}function a(n,r,a){t.success(n,a),e.info("Success: "+n,r)}function o(n,r,a){t.warning(n,a),e.warn("Warning: "+n,r)}var s={showToasts:!0,error:n,info:r,success:a,warning:o,log:e.log};return s}angular.module("blocks.logger").factory("logger",e),e.$inject=["$log","toastr"]}(),function(){"use strict";function e(){this.config={},this.$get=function(){return{config:this.config}}}function t(e,t,n,r,a,o){function s(e){e.forEach(function(e){e.config.resolve=angular.extend(e.config.resolve||{},a.config.resolveAlways),y.when(e.url,e.config)}),y.otherwise({redirectTo:"/login"})}function i(){t.$on("$routeChangeError",function(t,n,a,o){if(!m){h.errors++,m=!0;var s=n&&(n.title||n.name||n.loadedTemplateUrl)||"unknown target",i="Error routing to "+s+". "+(o.msg||"");r.warning(i,[n]),e.path("/")}})}function c(e){t.$on("$routeChangeStart",function(e,t,n,a){void 0===t.$$route&&(r.warning("Page not found"),f(v())),p(t.$$route)||(e.preventDefault(),r.warning("Unauthorised to visit page"),f(v()))})}function u(e){i(),c(e),d()}function l(){if(S.length<1)for(var e in n.routes)if(n.routes.hasOwnProperty(e)){var t=n.routes[e],r=!!t.title;r&&S.push(t)}return S.filter(p)}function d(){t.$on("$routeChangeSuccess",function(e,n,r){h.changes++,m=!1;var o=a.config.docTitle+" "+(n.title||"");t.title=o})}function f(t,n){var r=g(t,n);window.location.pathname.indexOf("#")<0?window.location="/#"+r:e.path(r)}function g(e,t){var n=l().filter(function(t){return t.title===e});if(n.length<1)return r.error("Failed to find matching route",e,"No matching route"),"";var a=n[0],o=a.originalPath;if(void 0!==t&&null!==t)for(var s in t)t.hasOwnProperty(s)&&(o=o.replace(":"+s,t[s]));return o}function p(e){if(e){if(!e.allowAnonymous&&!C().isLoggedIn)return!1;if(e.denyAuthorised&&C().isLoggedIn)return!1;if(e.claim&&!o.hasClaim(e.claim))return!1}return!0}function v(){var e=C(),t="dashboard";return e.isLoggedIn||(t="login"),t}var m=!1,h={errors:0,changes:0},S=[],y=a.config.$routeProvider,C=o.getUserIdentity,k={configureRoutes:s,getRoutes:l,routeCounts:h,redirectToRoute:f,getRouteFromName:g};return u(o.getUserIdentity),k}angular.module("blocks.router").provider("routehelperConfig",e).factory("routehelper",t),t.$inject=["$location","$rootScope","$route","logger","routehelperConfig","authService"]}();